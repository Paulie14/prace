


\section{eXtended Finite Element Method (XFEM)} \label{sec:soa_xfem}

The main feature of this method is the extension of a~space of basis polynomial shape functions of the finite element
method with a~special function, that enables to better approximate some local effects. This is called \emph{enrichment}.
The special function (enrichment function) is often non-polynomial and describes discontinuity or singularity,
where polynomials leak accuracy. We can meet two terms: \emph{extrinsic enrichment}, which adds the enrichment
functions to a~basis and \emph{intrinsic enrichment}, which replaces some basis functions with the enrichment ones.
We are interested in mesh-based methods with extrinsic enrichment and we shall not discuss any mesh-free alternatives.

An overview article by Fries and Belytschko~\cite{fries_xfem_overview_2010} concludes the history and early development
of the XFEM. The origins from the Partition of Unity Method (Babu{\v s}ka and Melenk e.g. in~\cite{babuska_partition_1997}) and
the Generalized Finite Element Method (e.g. by Strouboulis in~\cite{strouboulis_generalized_2000}) 
and the early XFEM (e.g. by Belytschko and Mo{\"e}s in \cite{moes_finite_1999}) are commented in details there.

The most frequent application of the XFEM is in mechanics, where people take advantage of the XFEM especially in
modelling cracks growth without requiring remeshing the computational mesh in time. 
Discontinuous functions (Heaviside function, signum) are used to capture the jump in stress or strain at the crack,
singular functions are applied in the vicinity of the crack tips. The exact function for the selected enrichment
comes either directly from the nature of the phenomenon, or can be obtained as the solution of a~local auxiliary
problem. This function is most often reffered as the \emph{global enrichment function}.

The XFEM is mainly perceived as a~method for local enrichment, which means that the enrichment is applied only
in a~small subdomain -- several elements of the computational mesh close to the local phenomenon.
The XFEM solution with a~single enrichment is sought in the form
\begin{equation} \label{eqn:soa_xfem_standard_form}
  u(x) = \sum_{\alpha\in\mathcal{I}}a_\alpha v_\alpha(x)
    + \sum_{\alpha\in\mathcal{I}^e} b_{\alpha} \phi_{\alpha}(x),
\end{equation}
where $a_\alpha$ are the standard FE degrees of freedom and $b_{\alpha}$ are the degrees of freedom coming from
the enrichment. $v_\alpha(x)$ are the standard FE basis shape functions. We denote the index sets $\mathcal{I}$ and
$\mathcal{I}^e$ that contain all indices of the standard and enriched degrees of freedom, respectively.
The \emph{local enrichment function} $\phi_{\alpha}$ in~\eqref{eqn:soa_xfem_standard_form} is typically defined as
\begin{equation} \label{eqn:soa_xfem_enrich}
    \phi_{\alpha} = N_\alpha(x)L(x), \quad \alpha\in\mathcal{I}^e,
\end{equation}
where $L$ is the actual enrichment function and $N_\alpha$ is a~function of the partition of unity
$\sum_\alpha N_\alpha(x) = 1$, creating the localised degrees of freedom for the enrichment.
Typically, $N_\alpha$ are linear FE basis functions, having support points at the mesh nodes, $N_\alpha(x_\alpha)=1$,
so one is often talking about enriching nodes and calling these \emph{enriched nodes}.
Different functions which make the partition of unity might be used, but linear functions are the most common.

% The index set $\mathcal{I}^e$ includes 
% all enriched nodes, i.e. the nodes that are in the vicinity of the effect, due to which we are applying the enrichment.

The most straightforward choice of $L(x)$ is the global enrichment function itself but it is not optimal. It can suffer with a~lack of convergence, a~large approximation error at some elements or an ill-conditioning of the linear system.
All these problems were intensively studied and lead to different XFEM methods:
the so called Corrected XFEM~\cite{fries_corrected_2008}
and the Stable Generalized Finite Element Method (SGFEM)~\cite{babuska_stable_2012, gupta_stable_2013}, which 
both became standard for XFEM in general. These are discussed in more details later on.

% TODO:
% Kronecker delta property $N_i(x_j) = \delta_{ij}$ (imposing BC, interpretation of results)
% sgfem - scaled condition number
% orthogonalization processes
% level set methods

Considering more than one enrichment is straightforward. The approximation will then change into the following form
\begin{equation} \label{eqn:soa_xfem_standard_form_mult1}
    u(x) = \sum_{\alpha\in\mathcal{I}}a_\alpha v_\alpha(x)
        + \sum_{e\in\mathcal{E}}\sum_{\alpha\in\mathcal{I}^e} b_{e\alpha} \phi_{e\alpha}(x)
\end{equation}
\begin{equation} \label{eqn:soa_xfem_standard_form_mult2}
    \phi_{e\alpha}(x) = N_\alpha(x)L_e(x), \quad e\in\mathcal{E},\; \alpha\in\mathcal{I}^e
\end{equation}
The enrichment $e$ is enriching all the nodes in the index set $\mathcal I^e$ with degrees of freedom $b_{e\alpha}$
corresponding to the local enrichment functions $\phi_{e\alpha}$. Note that there can be multiple functions $\phi_{e\alpha}$ with support on the same element. If these functions are close to each other in some measure in the approximation space, then the respective degrees of freedom can become linearly dependent which results in ill-conditioning of the linear system (SGFEM is mainly addressed to this issue).
% TODO: add some reference - e.g. something from Loehnert about orthogonalization (studies position of crack near the nodes)

\subsection{Global Enrichment Functions}
\label{sec:global_enrichment}
To fix the idea of an enrichment, we list the most common global enrichment functions that one meets in applications.

\subsubsection{Discontinuity}
% TODO: BC/interface approximation using XFEM (Nitsche's method, Hansbo and Hansbo)

A discontinuity at a~crack or an interface is one of the phenomena where XFEM is applied.
We talk about a~\emph{strong} discontinuity, if the quantity of interest is discontinuous (pressure in fluid mechanics, stress in mechanics, potential in electrostatics etc.).
The term \emph{weak} discontinuity is then used when the derivative of the quantity of interest is discontinuous (fluid velocity, strain or damage, electric current etc.).

The discontinuity is commonly described by a~\emph{levelset} function -- a~signed function,
that assings positive values to one part of the domain $\Omega$, negative values to the other part and is zero at the discontinuity/interface $\Gamma_{disc}$, for example
% cite TP Fries
\[
    \gamma(x) = \pm \min \norm{x-x_{disc}} \quad \forall x_{disc} \in \Gamma_{disc},\; \forall x \in \Omega.
\]
The global enrichment function then takes the form of a~signum or a~Heaviside function
\begin{eqnarray}
    s(x) &=& \textrm{sign}(\gamma(x)),\\
    s(x) &=& \textrm{H}(\gamma(x)).
\end{eqnarray}
for strong discontinuity, or
\begin{equation}
    s(x) = \abs{\gamma(x)}.
\end{equation}
for weak discontinuity, respectively.

The discontinuity location $\Gamma_{disc}(t)$ does not always have to be known explicitly and/or it can be time dependent.
In that situation the signed distance function $\gamma(x,t)$ can be obtained as a~solution of auxiliary problem, or be a~part of
the searched solution (e.g. in the article \cite{sauerland_stable_2013}
where the moving interface of two-phase flow is a~solution of a~transport equation).


\subsubsection{Singularity}
Another problematic phenomenon that damages the finite element approximation is singular or high gradient behaviour often present in the solution.
This kind of enrichment has its application at crack tips, re-entrant corners, point sources in 2d or line sources in 3d.
The last mentioned are important in the reduced dimensional models where they play the role in the coupling between dimensions.

A function with its singularity concentrated in a~single point has a~symmetric radial character.
Therefore the polar coordinates in 2d are commonly used and the global enrichment function $s(r,\theta)$ is defined in this coordinate system.
In three dimensional space the spheric or cylindric coordinate systems can be applied when the singularity is concentrated in a~point or on a~line, respectively.
The actual form of $s(r,\theta)$ is based on the solution of a~local auxiliary problems, e.g. the solution of a~simple 2d Laplace problem with a~single point source 
is $\log(r)$ dependent. Other found singular enrichment functions are $r^\alpha,\;\alpha\in\R$ dependent,
e.g. $\sqrt{r},\;1/r,\; 1/r^2$ in fracture mechanics collected in the Natarajan's thesis \cite{natarajan_enriched_2011}, table 2.3-2.5.
% e.g. $\sqrt{r},\;\frac{1}{r},\; \frac{1}{r^2}$ in fracture mechanics collected in the Natarajan's thesis \cite{natarajan_enriched_2011}, table 2.3-2.5.

High gradient in the solution occurs also in the vicinity of discontinuities. A~demonstrative examples are boundary (or interior) layers
in some convection dominated transport models. Abbas et al. in the article \cite{abbas_alizada_fries_highgradient_2010} described an XFEM with
a set of regularized (smooth) step functions that can capture arbitrary gradients and applied that method on linear advection-diffusion equation.

Typical is that these effects reach not only to the element where the singularity is located but also in its surroundings.




% In the \textbf{standard XFEM}, we write the solution in the form
% \begin{equation} \label{eqn:xfem_standard_form}
%   h(\bx) = \sum_{\alpha\in\mathcal{I}}a_\alpha N_\alpha(\bx)
%     + \sum_{w\in\mathcal{W}} \sum_{\alpha\in\mathcal{I}^e_w} b_{\alpha w} \phi_{\alpha w}(\bx),
% \end{equation}
% where $a_\alpha$ are the standard FE degrees of freedom and $b_{\alpha w}$ are the degrees of freedom coming from
% the enrichment of the well $w$. The index set $\mathcal{I}^e_w$ includes all nodes enriched by the well $w$; on the other hand, 
% at one node one can have several enrichment functions originating from different wells.
% The local enrichment functions $\phi_{\alpha w}$ in \eqref{eqn:xfem_standard_form} are defined
% in the following way
% \begin{equation} \label{eqn:xfem_enrich}
%     \phi_{\alpha w} = N_\alpha(\bx)L_{\alpha w}(\bx), \quad \alpha\in\mathcal{I}^e_w, w\in\mathcal{W},
% \end{equation}
% where the enrichment function is simply $L_{\alpha w}(\bx) = s_w(\bx)$.

 
\subsection{Local Enrichment Functions}
We now discuss different choices of the local enrichment functions $L(x)$ and their particular aspects and properties.
All the presented XFEM methods considered below are using the standard linear finite element shape 
functions $N_\alpha(x)$, $N_\alpha(x_\alpha)=1$, $\alpha\in\mathcal{I}=\{1,\ldots,N\}$, associated with the node $x_\alpha$ of the triangulation,
as the partition of unity.

\subsubsection{Corrected XFEM}
The corrected XFEM was introduced by T. P. Fries in \cite{fries_corrected_2008} and put in context of different XFEM in the detailed overview \cite{fries_xfem_overview_2010}.
He recognizes the \emph{reproducing} and \emph{blending} elements.
The former are the elements where all the nodes are enriched, therefore the complete partition of unity is present
and the enrichment function can be reproduced exactly. The later are the elements which have only some of its nodes enriched.

In the article, it is shown that the blending elements suffer from two drawbacks -- lack of a~partition of unity fails to reproduce enrichment function exactly;
unwanted terms show up in assembly on these elements which can significantly increase the approximation error.
 
To overcome these drawbacks, the corrected XFEM introduces the \emph{ramp function}, built from the linear basis functions,
\begin{eqnarray} \label{eqn:ramp_function}
  G(\bx) &=& \sum_{\alpha\in\mathcal{I}^e} N_\alpha(\bx)    \\
  &=& 
  \begin{cases}
    0 & \textrm{ on unenriched elements,}    \\
    1 & \textrm{ on reproducing elements (all the nodes are enriched),}    \\
    ramp & \textrm{ on blending elements (some of the nodes are enriched).}    \\
  \end{cases} \nonumber
\end{eqnarray}
and modifies the enrichment function into the form
\begin{eqnarray} \label{eqn:xfem_ramp}
    L(\bx) &=& G(\bx) s_(\bx),\\
    \phi_{\alpha}(\bx) &=& N_\alpha(\bx)L(\bx), \quad \alpha\in\mathcal{J}^e.
\end{eqnarray}
Note the set $\mathcal{J}^e$ which is slighty bigger than $\mathcal{I}^e$. It includes the nodes on the blending
elements which were previously unenriched. Thus $\mathcal{I}^e_w\subset\mathcal{J}^e_w$.
The ramp function keeps the properties on standard and reproducing elements (is constant 0 and 1, respectively),
but on blending elements it creates smooth transition between standard and enriched approximation. Due to
additional DoFs the modified enrichment function can be reproduced exactly and there is no lack of partition of unity.
The approximation of the original enrichment function is of course worse but it does not damage the convergence of the method.


In the same work, i.e. \cite{fries_corrected_2008}, author further suggest the \emph{shifted} enrichment functions in order 
to preserve the property of the standard 
FE approximation at nodes $h(\bx_\alpha)=a_\alpha$: the value at the node is equal to the corresponding degree
of freedom. The enrichment functions must be then zero at the nodes which is satisfied in the form
\begin{equation} \label{eqn:xfem_shift}
    L_{\alpha}(\bx) = G(\bx) \left[s(\bx) - s(\bx_\alpha)\right],
    \quad \alpha\in\mathcal{J}^e.
\end{equation} 
The property of the shifted formulation enables us to prescribe Dirichlet boundary condition such that
$a_\alpha = h_D(\bx_\alpha)$.

It has been also shown in many cases that both ramp function and shifting are needed to obtain optimal convergence rate.
In \cite{ventura_fast_2009}, authors analyse a~more general form of a~ramp function (calling the method a~weighted XFEM)
and compare different alternatives of shifting on crack and dislocation problems. The methods described above can be then seen
as special types of the weighted XFEM. 
% Let us call them the \textbf{ramp function XFEM}  
% and the \textbf{shifted XFEM} for the purpose of this article, as we shall reference to them later.


\subsubsection{SGFEM}
Finally, we present the \textbf{SGFEM}, according to \cite{babuska_stable_2012,gupta_stable_2013}. 
The enrichment function is defined as the subtraction of the global enrichment function and its interpolation 
\begin{equation} \label{eqn:sgfem_enrich}
    L_{\alpha}|_{\tau}(\bx) = s(\bx) - \pi_\tau (s)(\bx),
    \quad \alpha\in\mathcal{I}^e.
\end{equation} 
for any element $\tau$ of the mesh that have at least one enriched node.
The interpolation $\pi_\tau$ is built using the finite element shape functions
associated with nodes $\mathcal{I}(\tau)$ of the element $\tau$
\begin{equation} \label{eqn:sgfem_interpolation}
    \pi_\tau (s)(\bx) = \sum_{\beta\in\mathcal{I}(\tau)} N_\beta(\bx) s(\bx_\beta).
    %\quad \textrm{ on } \tau,\; \alpha\in\mathcal{I}^e, w\in\mathcal{W}.
\end{equation}
Notice that there are no additional enriched nodes on blending elements, like in $\mathcal{J}^e$ in 
\eqref{eqn:xfem_ramp} and \eqref{eqn:xfem_shift}, and no ramp function is involved.

\par\noindent\rule{\textwidth}{1pt}

The details on the enrichment application and actual formulation of the methods will be described in detail in Section
\ref{sec:discretization}. There, a~model for a~quasi-3D aquifers-wells problem according to Gracie and Craig~\cite{gracie_modelling_2010,craig_using_2011}
is developed and the XFEM is used to deal with the singularity in pressure at the wells (0D-2D coupling).

Usage of the XFEM is not of course hassle free and gratis. The presence of mostly non-polynomial enrichment functions
has a~huge impact on the system matrix assembly, where these functions must be integrated accurately enough.
Adaptive integration strategies are being developed for a~given class of enrichment functions (e.g. \cite{ventura_fast_2009}), 
but no general, robust and accurate solution is available. We will discuss the integration in detail in Section \ref{sec:integration}.
Another effect on the system matrix is the increase of its condition number because the local enrichment functions can
become nearly linearly dependent. 
% It was thought that the SGFEM is the answer to that problem but it has been
% reported that it is still not a~general solution.

Another problem is the stability of the discretization. In contrast to mechanics, the PDEs describing flow
need to satisfy a~strict discrete inf-sup condition (inequation 3.14, p. 75 in \cite{brezzi_mixed_1991} for mixed formulation).
This inequation is of course affected by the enrichment, however it is discussed in the literature minimally.


\section{XFEM in Flow Problems on Meshes of Combined Dimensions} \label{sec:soa_xfem_combined}

% reduced dimension concept
% energy correction method - solving reentrant corners
% dirac delta sources

There is much less to be found on the usage of the XFEM in the field of flow modelling, especially regarding the dimensions coupling,
than in mechanics.
% Many researchers are using some kind of the extended finite element method, but the applications are mainly aimed
% at problems in mechanics. 
% One of the reasons is that the stability of the discrete mixed form is more sensitive 
% on the choice of the finite elements used in flow problems. 
Apart from the references on various types of the XFEM in previous paragraph, we can name some works regarding flow and the XFEM.
Extensive work has been done in the area of modelling 1D-2D fractured domains with mixed finite 
elements by D'Angelo, Fumagalli and Scotti~\cite{fumagalli_numerical_2012, dangelo_mixed_2012, fumagalli_efficient_2014}. 
In there, the XFEM is used to incorporate additional degrees of freedom of zero order Raviart-Thomas basis 
functions on the intersected elements to allow the discontinuity in velocity. The trick is, that the same
basis functions are used but with different support. The model is formulated in 1D-2D at the moment.

Another work regarding 1D-2D fractures is by Schwenck~\cite{schwenck_xfem-based_2015} (also in \cite{schwenck_2015}), 
where the primary formulation is used and among others, the fracture tip and fractures intersection is dealt with.

Next, there are several publications on multi-phase fluid flow governed by Navier-Stokes equations using the XFEM for
approximation on the interfaces in 2D (\cite{diez_stable_2013,sauerland_stable_2013}). However, these are
little bit further from our application.

A 1D-3D model for investigation of the transport of substances in a~human body has been developed by D'Angelo 
and Zunino et al. (e.g in~\cite{dangelo_coupling_2008,cattaneo_numerical_2015}), without usage of the XFEM.
Further, 1D-3D coupling for blood flow and mass transport in vascularized human tissue is
investigated by K{\" o}ppl in\cite{koppl_tum_2015}.
